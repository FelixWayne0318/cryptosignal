# çœŸå®æ•°æ®å›æµ‹æŒ‡å—

## ğŸ“Œ é‡è¦è¯´æ˜

### å½“å‰å›æµ‹ç»“æœçš„çœŸå®æƒ…å†µ

**ä¹‹å‰çš„7å¤©å›æµ‹ä½¿ç”¨çš„æ˜¯Mockæ•°æ®**ï¼ŒåŒ…æ‹¬ï¼š
- âŒ æ¨¡æ‹Ÿçš„ä»·æ ¼æ•°æ®ï¼ˆgenerate_mock_price_data.pyï¼‰
- âŒ æ¨¡æ‹Ÿçš„ä¿¡å·æ•°æ®ï¼ˆgenerate_test_signals.pyï¼‰
- âœ… å›æµ‹å¼•æ“é€»è¾‘æ­£ç¡®ï¼ˆå·²éªŒè¯ï¼‰
- âœ… æ­¢ç›ˆæ­¢æŸæœºåˆ¶æ­£ç¡®ï¼ˆå·²éªŒè¯ï¼‰

**å‚è€ƒä»·å€¼**ï¼š
- âœ… å¯ä»¥éªŒè¯å›æµ‹ç³»ç»Ÿçš„æ­£ç¡®æ€§
- âœ… å¯ä»¥æµ‹è¯•ä¸åŒå‚æ•°çš„å½±å“
- âŒ **ä¸èƒ½ä»£è¡¨çœŸå®å¸‚åœºè¡¨ç°**

### ä¸ºä»€ä¹ˆéœ€è¦åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œï¼Ÿ

åœ¨å½“å‰ç¯å¢ƒä¸­ï¼Œå¸å®‰APIè¿”å› `403 Forbidden`ï¼ˆIPè¢«é™åˆ¶ï¼‰ï¼Œæ— æ³•è·å–çœŸå®æ•°æ®ã€‚

**éœ€è¦åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œæ‰èƒ½ï¼š**
- âœ… è®¿é—®å¸å®‰APIè·å–çœŸå®Kçº¿æ•°æ®
- âœ… è®¿é—®OIï¼ˆæŒä»“é‡ï¼‰æ•°æ®
- âœ… ä½¿ç”¨çœŸå®çš„analyze_symbolåˆ†æ
- âœ… ç”ŸæˆçœŸå®çš„äº¤æ˜“ä¿¡å·

---

## ğŸš€ åœ¨æœåŠ¡å™¨ä¸Šè¿è¡ŒçœŸå®å›æµ‹

### æ–¹æ¡ˆé€‰æ‹©

#### â­ **æ¨èï¼šåŸºäºå›ºå®šå¸ç§æ± å›æµ‹ï¼ˆç®€å•ï¼‰**

**ä¼˜ç‚¹**ï¼š
- âœ… ä¸éœ€è¦å®ç°å¤æ‚çš„é€‰å¸é€»è¾‘
- âœ… ä½¿ç”¨çœŸå®Kçº¿ã€OIã€CVDæ•°æ®
- âœ… èƒ½çœŸå®éªŒè¯analyze_symbolæ•ˆæœ
- âœ… èƒ½éªŒè¯æ­¢ç›ˆæ­¢æŸç­–ç•¥
- âœ… è®¡ç®—é‡å¯æ§

**ç¼ºç‚¹**ï¼š
- âŒ æ²¡æœ‰åŠ¨æ€é€‰å¸è¿‡ç¨‹
- âŒ å¯èƒ½é—æ¼ä¸€äº›é»‘é©¬å¸

#### **å®Œæ•´æµç¨‹å›æµ‹ï¼ˆå¤æ‚ï¼‰**

**éœ€è¦**ï¼š
- å†å²24h tickeræ•°æ®ï¼ˆéš¾ä»¥è·å–ï¼‰
- æ¯ä¸ªæ—¶é—´ç‚¹é‡å»ºå€™é€‰æ± 
- è®¡ç®—Z24ã€Triple Sync
- æ–°å¸æ£€æµ‹

**éš¾ç‚¹**ï¼š
- âŒ å¸å®‰ä¸æä¾›å†å²ticker API
- âŒ éœ€è¦é¢„å…ˆå­˜å‚¨å¤§é‡æ•°æ®
- âŒ è®¡ç®—é‡å·¨å¤§

---

## ğŸ“‹ æ“ä½œæ­¥éª¤ï¼ˆåœ¨æœåŠ¡å™¨ä¸Šï¼‰

### Step 1: å‡†å¤‡ç¯å¢ƒ

```bash
# SSHç™»å½•æœåŠ¡å™¨
ssh user@your-server

# è¿›å…¥é¡¹ç›®ç›®å½•
cd ~/cryptosignal

# ç¡®è®¤å¸å®‰APIå¯è®¿é—®
python3 -c "from ats_core.sources.binance_safe import get_klines; print('âœ… OK' if get_klines('BTCUSDT','1h',2) else 'âŒ Failed')"
```

### Step 2: è¿è¡ŒçœŸå®å›æµ‹

#### æ–¹æ¡ˆAï¼šå¿«é€Ÿå›æµ‹ï¼ˆ7å¤©ï¼Œ30ä¸ªå¸ï¼Œ2å°æ—¶é—´éš”ï¼‰

```bash
# è¿™æ˜¯æœ€æ¨èçš„é…ç½®
python3 tools/run_real_backtest.py --days 7 --interval 2
```

**é¢„è®¡æ—¶é—´**ï¼š10-20åˆ†é’Ÿ
**APIè°ƒç”¨**ï¼šçº¦ (7*24/2) * 30 = 2520 æ¬¡åˆ†æ

#### æ–¹æ¡ˆBï¼šå¯†é›†å›æµ‹ï¼ˆ7å¤©ï¼Œ30ä¸ªå¸ï¼Œ1å°æ—¶é—´éš”ï¼‰

```bash
# æ›´å¯†é›†çš„æ‰«æ
python3 tools/run_real_backtest.py --days 7 --interval 1
```

**é¢„è®¡æ—¶é—´**ï¼š20-40åˆ†é’Ÿ
**APIè°ƒç”¨**ï¼šçº¦ (7*24) * 30 = 5040 æ¬¡åˆ†æ

#### æ–¹æ¡ˆCï¼šæŒ‡å®šå¸ç§å›æµ‹

```bash
# åªå›æµ‹ç‰¹å®šå¸ç§ï¼ˆæ›´å¿«ï¼‰
python3 tools/run_real_backtest.py --days 7 --interval 2 \
  --symbols BTCUSDT ETHUSDT BNBUSDT SOLUSDT XRPUSDT
```

**é¢„è®¡æ—¶é—´**ï¼š3-5åˆ†é’Ÿ
**APIè°ƒç”¨**ï¼šçº¦ (7*24/2) * 5 = 420 æ¬¡åˆ†æ

### Step 3: æŸ¥çœ‹ç»“æœ

```bash
# æŸ¥çœ‹æœ€æ–°çš„å›æµ‹æŠ¥å‘Š
ls -lt data/backtest/reports/ | head -5

# æŸ¥çœ‹æŠ¥å‘Šå†…å®¹
cat data/backtest/reports/backtest_*.json | jq .

# æŸ¥çœ‹æ•°æ®åº“ä¸­çš„ä¿¡å·
python3 -c "
from ats_core.database.models import db, Signal
session = db.get_session()
count = session.query(Signal).count()
print(f'æ•°æ®åº“ä¸­å…±æœ‰ {count} ä¸ªä¿¡å·')
"
```

---

## âš™ï¸ é…ç½®è¯´æ˜

### é»˜è®¤å¸ç§æ± ï¼ˆ30ä¸ªï¼‰

```python
# Tier 1: è¶…å¤§å¸‚å€¼ï¼ˆ10ä¸ªï¼‰
'BTCUSDT', 'ETHUSDT', 'BNBUSDT', 'SOLUSDT', 'XRPUSDT',
'ADAUSDT', 'AVAXUSDT', 'DOGEUSDT', 'DOTUSDT', 'MATICUSDT',

# Tier 2: å¤§å¸‚å€¼å±±å¯¨ï¼ˆ10ä¸ªï¼‰
'LINKUSDT', 'UNIUSDT', 'ATOMUSDT', 'LTCUSDT', 'ETCUSDT',
'FILUSDT', 'APTUSDT', 'NEARUSDT', 'ICPUSDT', 'VETUSDT',

# Tier 3: çƒ­é—¨å±±å¯¨ï¼ˆ10ä¸ªï¼‰
'ARBUSDT', 'OPUSDT', 'SUIUSDT', 'INJUSDT', 'TIAUSDT',
'SEIUSDT', 'WLDUSDT', 'RNDRUSDT', 'FETUSDT', 'RENDERUSDT',
```

### å‚æ•°å»ºè®®

| å‚æ•° | æ¨èå€¼ | è¯´æ˜ |
|------|--------|------|
| `--days` | 7 | å›æµ‹å¤©æ•°ï¼Œå»ºè®®ä»å°èŒƒå›´å¼€å§‹ |
| `--interval` | 2 | æ‰«æé—´éš”ï¼ˆå°æ—¶ï¼‰ï¼Œå¹³è¡¡é€Ÿåº¦å’Œç²¾åº¦ |
| `--symbols` | é»˜è®¤30ä¸ª | å¯ä»¥æŒ‡å®šæ›´å°‘çš„å¸ç§åŠ å¿«é€Ÿåº¦ |

### é¢„è®¡èµ„æºæ¶ˆè€—

| é…ç½® | æ—¶é—´ | APIè°ƒç”¨ | å†…å­˜ |
|------|------|---------|------|
| 7å¤© Ã— 30å¸ Ã— 2h | 10-20åˆ†é’Ÿ | ~2500æ¬¡ | ~500MB |
| 7å¤© Ã— 30å¸ Ã— 1h | 20-40åˆ†é’Ÿ | ~5000æ¬¡ | ~800MB |
| 7å¤© Ã— 10å¸ Ã— 2h | 3-5åˆ†é’Ÿ | ~840æ¬¡ | ~200MB |

---

## ğŸ”§ å¦‚æœé‡åˆ°é—®é¢˜

### é—®é¢˜1ï¼šå¸å®‰API 403é”™è¯¯

```
âŒ å¸å®‰APIæµ‹è¯•å¤±è´¥: HTTP Error 403: Forbidden
```

**åŸå› **ï¼šæœåŠ¡å™¨IPè¢«å¸å®‰é™åˆ¶

**è§£å†³**ï¼š
1. æ£€æŸ¥æ˜¯å¦åœ¨å›½å†…æœåŠ¡å™¨ï¼ˆéœ€è¦ä»£ç†ï¼‰
2. æ£€æŸ¥IPæ˜¯å¦è¢«å°ç¦
3. å°è¯•ä½¿ç”¨å¤‡ç”¨APIï¼ˆå¦‚æœæœ‰ï¼‰

### é—®é¢˜2ï¼šanalyze_symbolå¤±è´¥

```
âš ï¸  BTCUSDT åˆ†æå¤±è´¥: ...
```

**åŸå› **ï¼šæ•°æ®ä¸è¶³ã€ç½‘ç»œé—®é¢˜ã€å¸ç§ä¸å­˜åœ¨

**è§£å†³**ï¼š
- è¿™æ˜¯æ­£å¸¸çš„ï¼Œéƒ¨åˆ†å¸ç§å¯èƒ½æ•°æ®ä¸è¶³
- å¦‚æœå¤±è´¥ç‡>30%ï¼Œæ£€æŸ¥ç½‘ç»œå’ŒAPI
- å¯ä»¥è·³è¿‡è¿™äº›å¸ç§

### é—®é¢˜3ï¼šè¿è¡Œæ—¶é—´è¿‡é•¿

**ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š
1. å‡å°‘å¸ç§æ•°é‡ï¼ˆ10-15ä¸ªï¼‰
2. å¢å¤§æ‰«æé—´éš”ï¼ˆ4å°æ—¶ï¼‰
3. ç¼©çŸ­å›æµ‹æ—¶é—´ï¼ˆ3å¤©ï¼‰

```bash
# å¿«é€Ÿæµ‹è¯•é…ç½®
python3 tools/run_real_backtest.py --days 3 --interval 4 \
  --symbols BTCUSDT ETHUSDT BNBUSDT SOLUSDT XRPUSDT
```

---

## ğŸ“Š è¾“å‡ºå†…å®¹

### 1. ç»ˆç«¯è¾“å‡º

```
çœŸå®æ•°æ®å›æµ‹å¼•æ“
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“… æ—¶é—´èŒƒå›´: 2025-10-18 åˆ° 2025-10-25
ğŸª™  å¸ç§æ± : 30ä¸ªå¸ç§
â±ï¸  æ‰«æé—´éš”: 2å°æ—¶
ğŸ’¾ ä¿å­˜ä¿¡å·: æ˜¯

â° [12.5%] 2025-10-19 12:00 | å·²ç”Ÿæˆ: 5 (â­2 + ğŸ‘€3)
  â­ ä¿¡å·#1: BTCUSDT LONG @ 67234.50 (Prob: 67.8%)
  ğŸ‘€ ä¿¡å·#2: ETHUSDT SHORT @ 3456.78 (Prob: 61.2%)
  ...

æ‰«æç»Ÿè®¡
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
æ€»æ‰«ææ¬¡æ•°:     84
æ€»åˆ†ææ¬¡æ•°:     2520
æˆåŠŸç‡:         96.8%
ç”Ÿæˆä¿¡å·:       45
  â­ Prime:     18 (40.0%)
  ğŸ‘€ Watch:     27 (60.0%)
ä¿¡å·ç”Ÿæˆç‡:     1.79%
```

### 2. å›æµ‹æŠ¥å‘Š

ä¿å­˜åœ¨ï¼š`data/backtest/reports/backtest_YYYYMMDD_HHMMSS.json`

åŒ…å«ï¼š
- è¯¦ç»†çš„äº¤æ˜“è®°å½•
- æ€§èƒ½æŒ‡æ ‡
- æƒç›Šæ›²çº¿
- é…ç½®ä¿¡æ¯

### 3. æ•°æ®åº“ä¿¡å·

å¦‚æœå¯ç”¨äº†ä¿å­˜ï¼ˆé»˜è®¤å¯ç”¨ï¼‰ï¼Œä¿¡å·ä¼šä¿å­˜åˆ°ï¼š
- è¡¨ï¼š`signals`
- æ•°æ®åº“ï¼š`data/database/cryptosignal.db`

---

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. å…ˆå°èŒƒå›´æµ‹è¯•

```bash
# æµ‹è¯•1å¤©ï¼Œ5ä¸ªå¸
python3 tools/run_real_backtest.py --days 1 --interval 2 \
  --symbols BTCUSDT ETHUSDT BNBUSDT SOLUSDT XRPUSDT
```

### 2. é€æ­¥æ‰©å¤§èŒƒå›´

```bash
# æµ‹è¯•3å¤©ï¼Œ15ä¸ªå¸
python3 tools/run_real_backtest.py --days 3 --interval 2

# æ­£å¼å›æµ‹7å¤©ï¼Œ30ä¸ªå¸
python3 tools/run_real_backtest.py --days 7 --interval 2
```

### 3. å¯¹æ¯”ä¸åŒå‚æ•°

```bash
# ä¿å­˜ä¸åŒé…ç½®çš„ç»“æœï¼Œå¯¹æ¯”æ•ˆæœ
python3 tools/run_real_backtest.py --days 7 --interval 1  # å¯†é›†
python3 tools/run_real_backtest.py --days 7 --interval 2  # æ ‡å‡†
python3 tools/run_real_backtest.py --days 7 --interval 4  # ç¨€ç–
```

### 4. åˆ†æç»“æœ

```python
# å¯¹æ¯”å¤šæ¬¡å›æµ‹ç»“æœ
import json
from pathlib import Path

reports_dir = Path('data/backtest/reports')
reports = sorted(reports_dir.glob('backtest_*.json'))

for report_file in reports[-5:]:  # æœ€è¿‘5æ¬¡
    with open(report_file) as f:
        data = json.load(f)
        metrics = data['metrics']
        print(f"{report_file.name}:")
        print(f"  èƒœç‡: {metrics['win_rate']*100:.1f}%")
        print(f"  æ”¶ç›Š: {metrics['total_return']*100:+.2f}%")
        print(f"  ç›ˆåˆ©å› å­: {metrics['profit_factor']:.2f}")
        print()
```

---

## ğŸ¯ æ€»ç»“

### Mockæ•°æ®å›æµ‹ï¼ˆå½“å‰ï¼‰
- âœ… éªŒè¯ç³»ç»Ÿé€»è¾‘
- âœ… å¿«é€Ÿæµ‹è¯•
- âŒ ä¸èƒ½ä»£è¡¨çœŸå®è¡¨ç°

### çœŸå®æ•°æ®å›æµ‹ï¼ˆæœåŠ¡å™¨ï¼‰
- âœ… çœŸå®å¸‚åœºè¡¨ç°
- âœ… å¯ä¿¡çš„å›æµ‹ç»“æœ
- âŒ éœ€è¦æœåŠ¡å™¨ç¯å¢ƒ
- âŒ éœ€è¦æ›´é•¿æ—¶é—´

### è¡ŒåŠ¨å»ºè®®

1. **ç«‹å³è¡ŒåŠ¨**ï¼šåœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œç®€å•æµ‹è¯•
   ```bash
   python3 tools/run_real_backtest.py --days 1 --symbols BTCUSDT ETHUSDT
   ```

2. **éªŒè¯æ•ˆæœ**ï¼šå¦‚æœè¿è¡ŒæˆåŠŸï¼Œæ‰©å¤§èŒƒå›´
   ```bash
   python3 tools/run_real_backtest.py --days 7
   ```

3. **åˆ†æç»“æœ**ï¼šåŸºäºçœŸå®æ•°æ®ä¼˜åŒ–ç­–ç•¥

4. **æŒç»­æ”¹è¿›**ï¼šæ¯å‘¨è¿è¡Œä¸€æ¬¡ï¼Œç›‘æ§æ•ˆæœ

---

**éœ€è¦æˆ‘ååŠ©åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œå—ï¼Ÿ**

å¦‚æœæ‚¨æƒ³åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œï¼Œå¯ä»¥ï¼š
1. ç›´æ¥è¿è¡Œä¸Šè¿°å‘½ä»¤
2. æˆ–è€…æŠŠç»“æœæ—¥å¿—å‘ç»™æˆ‘ï¼Œæˆ‘å¸®æ‚¨åˆ†æ

é€‰å¸å›æµ‹ç¡®å®å¤æ‚ï¼Œ**å»ºè®®å…ˆç”¨å›ºå®šå¸ç§æ± æµ‹è¯•**ï¼Œç­‰ç³»ç»Ÿç¨³å®šåå†è€ƒè™‘åŠ¨æ€é€‰å¸å›æµ‹ã€‚
