# é…ç½®ç®¡ç†ç³»ç»Ÿå®æ–½æ¸…å•

## çŠ¶æ€è¯´æ˜
- â¬œ æœªå¼€å§‹
- ğŸ”„ è¿›è¡Œä¸­
- âœ… å·²å®Œæˆ
- âš ï¸ æœ‰é—®é¢˜

---

## P0ä¼˜å…ˆçº§ï¼ˆå¿…é¡»ç«‹å³å®Œæˆ - 1ä¸ªå·¥ä½œæ—¥ï¼‰

### Step 1: æ›´æ–°é…ç½®æ–‡ä»¶ï¼ˆ1å°æ—¶ï¼‰
- â¬œ å¤‡ä»½ç°æœ‰é…ç½®æ–‡ä»¶
  ```bash
  cp config/factors_unified.json config/factors_unified.json.v2.0.backup
  ```
  
- â¬œ æ·»åŠ `global`é…ç½®section
  - â¬œ `global.standardization` - StandardizationChainå…¨å±€é…ç½®
  - â¬œ `global.standardization.default_params` - é»˜è®¤å‚æ•°
  - â¬œ `global.standardization.factor_overrides` - å› å­çº§è¦†ç›–
  - â¬œ `global.data_quality` - æ•°æ®è´¨é‡é˜ˆå€¼
  - â¬œ `global.degradation` - é™çº§ç­–ç•¥

- â¬œ æ›´æ–°Må› å­paramsï¼ˆä¸ä»£ç ä¸€è‡´ï¼‰
  - â¬œ ç§»é™¤è¿‡æ—¶çš„`lookback_periods`, `acceleration_window`
  - â¬œ æ·»åŠ å®é™…ä½¿ç”¨çš„`ema_fast=3`, `ema_slow=5`, `slope_lookback=6`ç­‰

- â¬œ æ›´æ–°å…¶ä»–å› å­paramsï¼ˆC+, V+, O+, T, Sï¼‰

- â¬œ æ›´æ–°versionä¸º"3.0.0"

### Step 2: æ‰©å±•FactorConfigï¼ˆ2å°æ—¶ï¼‰
- â¬œ åœ¨`ats_core/config/factor_config.py`æ·»åŠ æ–°æ–¹æ³•ï¼š
  - â¬œ `get_standardization_params(factor_name)` - è·å–StandardizationChainå‚æ•°
  - â¬œ `get_data_quality_threshold(factor_name, threshold_type)` - è·å–æ•°æ®è´¨é‡é˜ˆå€¼
  - â¬œ `get_degradation_strategy()` - è·å–é™çº§ç­–ç•¥
  - â¬œ `should_log_degradation()` - æ˜¯å¦è®°å½•é™çº§äº‹ä»¶
  - â¬œ `validate_config()` - éªŒè¯é…ç½®æ–‡ä»¶
  - â¬œ `get_factor_config_full(factor_name)` - è·å–å®Œæ•´é…ç½®

- â¬œ æ·»åŠ å•å…ƒæµ‹è¯•
  - â¬œ `test_get_standardization_params()`
  - â¬œ `test_get_data_quality_threshold()`

### Step 3: åˆ›å»ºé…ç½®éªŒè¯å™¨ï¼ˆ2å°æ—¶ï¼‰
- â¬œ åˆ›å»º`ats_core/config/config_validator.py`

- â¬œ å®ç°`ConfigValidator`ç±»
  - â¬œ å®šä¹‰å› å­å‚æ•°è§„èŒƒ`FACTOR_PARAM_SPECS`
  - â¬œ å®šä¹‰StandardizationChainå‚æ•°è§„èŒƒ`STANDARDIZATION_SPECS`
  - â¬œ å®ç°`validate()` - ä¸»éªŒè¯æ–¹æ³•
  - â¬œ å®ç°`_validate_global_config()` - éªŒè¯å…¨å±€é…ç½®
  - â¬œ å®ç°`_validate_factors()` - éªŒè¯å› å­é…ç½®
  - â¬œ å®ç°`_validate_params()` - éªŒè¯å‚æ•°ï¼ˆç±»å‹ã€èŒƒå›´ï¼‰
  - â¬œ å®ç°`_validate_consistency()` - éªŒè¯ä¸€è‡´æ€§ï¼ˆæƒé‡å’Œç­‰ï¼‰
  - â¬œ å®ç°`_generate_report()` - ç”ŸæˆéªŒè¯æŠ¥å‘Š
  - â¬œ å®ç°`print_report()` - æ‰“å°éªŒè¯æŠ¥å‘Š

- â¬œ æ·»åŠ å•å…ƒæµ‹è¯•
  - â¬œ `test_config_validation()` - æµ‹è¯•é…ç½®éªŒè¯

### Step 4: é‡æ„Må› å­ï¼ˆ2å°æ—¶ï¼‰
- â¬œ é‡æ„`ats_core/features/momentum.py`

- â¬œ ç§»é™¤ç¡¬ç¼–ç 
  - â¬œ ç§»é™¤æ¨¡å—çº§`_momentum_chain`çš„ç¡¬ç¼–ç å‚æ•°
  - â¬œ ç§»é™¤`default_params`å­—å…¸
  - â¬œ ç§»é™¤ç¡¬ç¼–ç çš„`len(c) < 20`æ£€æŸ¥

- â¬œ æ·»åŠ é…ç½®é›†æˆ
  - â¬œ å®ç°`_get_momentum_chain()` - å»¶è¿Ÿåˆå§‹åŒ–ï¼Œä½¿ç”¨é…ç½®
  - â¬œ ä¿®æ”¹`score_momentum()`ä½¿ç”¨é…ç½®è·å–å‚æ•°
  - â¬œ ä¿®æ”¹æ•°æ®è´¨é‡æ£€æŸ¥ä½¿ç”¨é…ç½®é˜ˆå€¼
  - â¬œ æ·»åŠ é™çº§ç­–ç•¥å¤„ç†

- â¬œ ç¡®ä¿å‘åå…¼å®¹
  - â¬œ ä¿æŒ`params`å‚æ•°å¯é€‰
  - â¬œ ä¼ å…¥çš„paramsä¼˜å…ˆçº§é«˜äºé…ç½®æ–‡ä»¶

- â¬œ æ·»åŠ æµ‹è¯•
  - â¬œ `test_momentum_uses_config()` - æµ‹è¯•ä½¿ç”¨é…ç½®
  - â¬œ `test_momentum_backwards_compatibility()` - æµ‹è¯•å‘åå…¼å®¹
  - â¬œ `test_momentum_degradation()` - æµ‹è¯•é™çº§å¤„ç†

---

## P1ä¼˜å…ˆçº§ï¼ˆä¸€å‘¨å†…å®Œæˆ - 2ä¸ªå·¥ä½œæ—¥ï¼‰

### Step 5: é‡æ„C+å› å­ï¼ˆ2å°æ—¶ï¼‰
- â¬œ é‡æ„`ats_core/features/cvd_flow.py`
- â¬œ ç§»é™¤ç¡¬ç¼–ç StandardizationChainå‚æ•°
- â¬œ ç§»é™¤default_paramså­—å…¸
- â¬œ ä½¿ç”¨é…ç½®ç³»ç»Ÿ
- â¬œ æ·»åŠ æµ‹è¯•

### Step 6: é‡æ„V+å› å­ï¼ˆ2å°æ—¶ï¼‰
- â¬œ é‡æ„`ats_core/features/volume.py`
- â¬œ ç§»é™¤ç¡¬ç¼–ç StandardizationChainå‚æ•°
- â¬œ ç§»é™¤default_paramså­—å…¸
- â¬œ ä½¿ç”¨é…ç½®ç³»ç»Ÿ
- â¬œ æ·»åŠ æµ‹è¯•

### Step 7: é‡æ„O+å› å­ï¼ˆ2å°æ—¶ï¼‰
- â¬œ é‡æ„`ats_core/features/open_interest.py`
- â¬œ ä¿®å¤z0é‡å¤å®šä¹‰bug
- â¬œ ç§»é™¤ç¡¬ç¼–ç StandardizationChainå‚æ•°
- â¬œ ç§»é™¤default_parå­—å…¸
- â¬œ ä½¿ç”¨é…ç½®ç³»ç»Ÿ
- â¬œ æ·»åŠ æµ‹è¯•

### Step 8: é‡æ„Tå› å­ï¼ˆ2å°æ—¶ï¼‰
- â¬œ é‡æ„`ats_core/features/trend.py`
- â¬œ ç§»é™¤ç¡¬ç¼–ç StandardizationChainå‚æ•°
- â¬œ ä½¿ç”¨é…ç½®ç³»ç»Ÿï¼ˆTå·²ç»ä»cfgè¯»å–ï¼Œç®€åŒ–ï¼‰
- â¬œ æ·»åŠ æµ‹è¯•

### Step 9: é‡æ„Så› å­ï¼ˆ1å°æ—¶ï¼‰
- â¬œ é‡æ„`ats_core/features/structure_sq.py`
- â¬œ ç§»é™¤ç¡¬ç¼–ç StandardizationChainå‚æ•°ï¼ˆå·²ç¦ç”¨ï¼Œä¿æŒç¦ç”¨ï¼‰
- â¬œ ä½¿ç”¨é…ç½®ç³»ç»Ÿ
- â¬œ æ·»åŠ æµ‹è¯•

### Step 10: é‡æ„L/B/Q/I/Få› å­ï¼ˆ5å°æ—¶ï¼‰
- â¬œ è¯»å–å¹¶åˆ†æè¿™äº›å› å­çš„ä»£ç 
- â¬œ è¯†åˆ«ç¡¬ç¼–ç å‚æ•°
- â¬œ æ·»åŠ é…ç½®åˆ°factors_unified.json
- â¬œ é‡æ„ä»£ç ä½¿ç”¨é…ç½®ç³»ç»Ÿ
- â¬œ æ·»åŠ æµ‹è¯•

### Step 11: é›†æˆå¯åŠ¨æµç¨‹ï¼ˆ1å°æ—¶ï¼‰
- â¬œ åˆ›å»ºå¯åŠ¨éªŒè¯å‡½æ•°`startup_validation()`
  
- â¬œ é›†æˆåˆ°ä¸»ç¨‹åº
  - â¬œ åœ¨å¯åŠ¨æ—¶è°ƒç”¨é…ç½®éªŒè¯
  - â¬œ éªŒè¯å¤±è´¥æ—¶ç»ˆæ­¢ç¨‹åº
  - â¬œ æ‰“å°éªŒè¯æŠ¥å‘Š

- â¬œ æ·»åŠ é›†æˆæµ‹è¯•
  - â¬œ `test_all_factors_use_config()` - æµ‹è¯•æ‰€æœ‰å› å­éƒ½ä½¿ç”¨é…ç½®
  - â¬œ `test_startup_validation()` - æµ‹è¯•å¯åŠ¨éªŒè¯

---

## P2ä¼˜å…ˆçº§ï¼ˆå¯é€‰å¢å¼º - 0.5ä¸ªå·¥ä½œæ—¥ï¼‰

### Step 12: é…ç½®çƒ­é‡è½½ï¼ˆ2å°æ—¶ï¼‰
- â¬œ å®‰è£…watchdogåº“
  ```bash
  pip install watchdog
  ```

- â¬œ å®ç°`ConfigReloadHandler`
  - â¬œ ç›‘å¬factors_unified.jsonæ–‡ä»¶ä¿®æ”¹
  - â¬œ è‡ªåŠ¨é‡æ–°åŠ è½½é…ç½®
  - â¬œ å¤„ç†StandardizationChainçŠ¶æ€

- â¬œ æ·»åŠ reloadæµ‹è¯•
  - â¬œ `test_config_hot_reload()` - æµ‹è¯•çƒ­é‡è½½

### Step 13: é…ç½®ç»§æ‰¿å’Œç¯å¢ƒè¦†ç›–ï¼ˆ2å°æ—¶ï¼‰
- â¬œ å®ç°å¤šç¯å¢ƒé…ç½®æ”¯æŒ
  - â¬œ `factors_unified.json` - é»˜è®¤é…ç½®
  - â¬œ `factors_unified.dev.json` - å¼€å‘ç¯å¢ƒè¦†ç›–
  - â¬œ `factors_unified.prod.json` - ç”Ÿäº§ç¯å¢ƒè¦†ç›–

- â¬œ å®ç°é…ç½®åˆå¹¶é€»è¾‘`_merge_configs()`

- â¬œ æ·»åŠ ç¯å¢ƒå˜é‡æ”¯æŒ
  ```bash
  export ATS_ENV=dev  # æˆ– prod
  ```

- â¬œ æ·»åŠ æµ‹è¯•
  - â¬œ `test_config_inheritance()` - æµ‹è¯•é…ç½®ç»§æ‰¿
  - â¬œ `test_environment_override()` - æµ‹è¯•ç¯å¢ƒè¦†ç›–

---

## éªŒæ”¶æ ‡å‡†

### P0éªŒæ”¶ï¼ˆå¿…é¡»å…¨éƒ¨é€šè¿‡ï¼‰
- âœ… é…ç½®æ–‡ä»¶æ ¼å¼æ­£ç¡®ï¼ŒéªŒè¯é€šè¿‡
- âœ… Må› å­å®Œå…¨ä½¿ç”¨é…ç½®ç³»ç»Ÿï¼Œ0ä¸ªç¡¬ç¼–ç 
- âœ… æ‰€æœ‰æ–°å¢æ–¹æ³•æœ‰å•å…ƒæµ‹è¯•
- âœ… å‘åå…¼å®¹æ€§æµ‹è¯•å…¨éƒ¨é€šè¿‡
- âœ… é…ç½®éªŒè¯å™¨æ­£ç¡®è¯†åˆ«é”™è¯¯

### P1éªŒæ”¶ï¼ˆå¿…é¡»å…¨éƒ¨é€šè¿‡ï¼‰
- âœ… æ‰€æœ‰10+1ä¸ªå› å­å®Œå…¨ä½¿ç”¨é…ç½®ç³»ç»Ÿ
- âœ… 0ä¸ªç¡¬ç¼–ç StandardizationChainå‚æ•°
- âœ… 0ä¸ªç¡¬ç¼–ç default_paramså­—å…¸
- âœ… å¯åŠ¨éªŒè¯é›†æˆåˆ°ä¸»ç¨‹åº
- âœ… æ‰€æœ‰é›†æˆæµ‹è¯•é€šè¿‡

### P2éªŒæ”¶ï¼ˆå¯é€‰ï¼‰
- âœ… é…ç½®çƒ­é‡è½½åŠŸèƒ½æ­£å¸¸
- âœ… å¤šç¯å¢ƒé…ç½®æ”¯æŒæ­£å¸¸
- âœ… çƒ­é‡è½½æµ‹è¯•é€šè¿‡

---

## é£é™©ç¼“è§£æ¸…å•

### å‘åå…¼å®¹æ€§ç ´åï¼ˆHIGHé£é™©ï¼‰
- âœ… ä¿æŒparamså‚æ•°å¯é€‰
- âœ… ä¼ å…¥çš„paramsä¼˜å…ˆçº§é«˜äºé…ç½®æ–‡ä»¶
- âœ… æ·»åŠ å‘åå…¼å®¹æ€§æµ‹è¯•
- â¬œ è€ƒè™‘æ·»åŠ deprecationè­¦å‘Šï¼ˆå¯é€‰ï¼‰

### é…ç½®æ–‡ä»¶é”™è¯¯ï¼ˆHIGHé£é™©ï¼‰
- âœ… å¯åŠ¨æ—¶éªŒè¯é…ç½®æ–‡ä»¶
- âœ… æä¾›è¯¦ç»†é”™è¯¯ä¿¡æ¯
- âœ… ä¿ç•™é…ç½®æ–‡ä»¶å¤‡ä»½
- â¬œ è€ƒè™‘æ·»åŠ é…ç½®æ–‡ä»¶JSON Schemaï¼ˆå¯é€‰ï¼‰

### StandardizationChainå‚æ•°å˜åŒ–ï¼ˆMEDIUMé£é™©ï¼‰
- âœ… ä½¿ç”¨factor_overridesä¿ç•™ç°æœ‰å‚æ•°
- â¬œ åœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯åˆ†æ•°åˆ†å¸ƒ
- â¬œ æ¯”è¾ƒä¿®æ”¹å‰åçš„å› å­åˆ†æ•°
- â¬œ é€æ­¥è°ƒæ•´å‚æ•°ï¼ˆå¦‚æœéœ€è¦ï¼‰

---

## è¿›åº¦è·Ÿè¸ª

| é˜¶æ®µ | çŠ¶æ€ | å¼€å§‹æ—¶é—´ | å®Œæˆæ—¶é—´ | å¤‡æ³¨ |
|------|------|----------|----------|------|
| P0 - Step 1 | â¬œ | - | - | æ›´æ–°é…ç½®æ–‡ä»¶ |
| P0 - Step 2 | â¬œ | - | - | æ‰©å±•FactorConfig |
| P0 - Step 3 | â¬œ | - | - | åˆ›å»ºé…ç½®éªŒè¯å™¨ |
| P0 - Step 4 | â¬œ | - | - | é‡æ„Må› å­ |
| P1 - Step 5 | â¬œ | - | - | é‡æ„C+å› å­ |
| P1 - Step 6 | â¬œ | - | - | é‡æ„V+å› å­ |
| P1 - Step 7 | â¬œ | - | - | é‡æ„O+å› å­ |
| P1 - Step 8 | â¬œ | - | - | é‡æ„Tå› å­ |
| P1 - Step 9 | â¬œ | - | - | é‡æ„Så› å­ |
| P1 - Step 10 | â¬œ | - | - | é‡æ„L/B/Q/I/Få› å­ |
| P1 - Step 11 | â¬œ | - | - | é›†æˆå¯åŠ¨æµç¨‹ |
| P2 - Step 12 | â¬œ | - | - | é…ç½®çƒ­é‡è½½ï¼ˆå¯é€‰ï¼‰ |
| P2 - Step 13 | â¬œ | - | - | é…ç½®ç»§æ‰¿ï¼ˆå¯é€‰ï¼‰ |

---

## é¢„ä¼°æ€»å·¥ä½œé‡

| ä¼˜å…ˆçº§ | ä»»åŠ¡æ•° | é¢„ä¼°æ—¶é—´ | å·¥ä½œæ—¥ |
|--------|--------|----------|--------|
| P0 | 4 | 7å°æ—¶ | 1å¤© |
| P1 | 7 | 16å°æ—¶ | 2å¤© |
| P2ï¼ˆå¯é€‰ï¼‰ | 2 | 4å°æ—¶ | 0.5å¤© |
| **æ€»è®¡** | **13** | **27å°æ—¶** | **3.5å¤©** |

---

**åˆ›å»ºæ—¶é—´**: 2025-11-09  
**æœ€åæ›´æ–°**: 2025-11-09  
**çŠ¶æ€**: å¾…å¼€å§‹
