================================================================================
CryptoSignal v6.1 服务器部署命令
================================================================================

复制以下命令到服务器执行（逐步执行）：

# ============================================================================
# 第 1 步：进入项目目录
# ============================================================================
cd ~/cryptosignal

# ============================================================================
# 第 2 步：拉取v6.1代码
# ============================================================================
git fetch origin claude/review-system-overview-011CUhLQjByWuXC1bySJCHKQ
git checkout claude/review-system-overview-011CUhLQjByWuXC1bySJCHKQ
git pull origin claude/review-system-overview-011CUhLQjByWuXC1bySJCHKQ

# 验证：应该看到最新提交 ecd96ae
git log --oneline -3

# ============================================================================
# 第 3 步：运行完整部署脚本（包含所有验证）
# ============================================================================
./deploy_v6.1.sh

# 该脚本会自动完成：
#   1. 停止旧进程
#   2. 备份配置文件
#   3. 验证代码修复（权重、阈值、防抖动）
#   4. 验证Telegram和Binance配置
#   5. 清理Python缓存
#   6. 快速测试运行
#   7. 显示启动命令

# ============================================================================
# 第 4 步：启动生产环境（三选一）
# ============================================================================

# 方式 1：使用快速启动脚本（推荐）
./start_production.sh
# 然后选择 1（Screen会话）

# -------- 或 --------

# 方式 2：手动Screen启动
screen -S cryptosignal
python3 scripts/realtime_signal_scanner.py --interval 300
# 初始化完成后按 Ctrl+A 然后 D 分离

# -------- 或 --------

# 方式 3：后台运行（nohup）
mkdir -p logs
nohup python3 scripts/realtime_signal_scanner.py --interval 300 > logs/scanner_$(date +%Y%m%d_%H%M%S).log 2>&1 &

# ============================================================================
# 第 5 步：验证运行状态
# ============================================================================

# 检查进程
ps aux | grep realtime_signal_scanner

# 查看日志（Screen）
screen -r cryptosignal
# 按 Ctrl+A 然后 D 退出

# 查看日志（nohup）
tail -f logs/scanner_*.log

# ============================================================================
# 常用命令
# ============================================================================

# 重连Screen会话
screen -r cryptosignal

# 停止进程
ps aux | grep realtime_signal_scanner | grep -v grep | awk '{print $2}' | xargs kill

# 查看运行状态
ps aux | grep realtime_signal_scanner | grep -v grep

# 查看Telegram是否收到信号
# （检查Telegram app中的通知）

================================================================================
v6.1 修复摘要
================================================================================

✅ I因子架构修正（A层 → B层）
✅ Prime阈值降低（35 → 25分）
✅ 概率阈值降低（0.62 → 0.58）
✅ 防抖动放宽（1/2确认，60秒冷却，0.65阈值）

预期效果：
  • 信号量：3-7个Prime信号/小时（140币种）
  • 响应速度：提升33%
  • 信号质量：维持高质量

================================================================================
故障排查
================================================================================

如果遇到问题：

1. 依赖缺失
   pip3 install -r requirements.txt

2. 配置文件不存在
   检查 config/binance_credentials.json 和 config/telegram.json

3. 进程异常退出
   前台运行查看错误：python3 scripts/realtime_signal_scanner.py --interval 300

4. 详细文档
   查看 DEPLOYMENT_v6.1.md

================================================================================
