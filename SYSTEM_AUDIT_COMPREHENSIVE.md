# ç³»ç»Ÿå…¨é¢å®¡è®¡æŠ¥å‘Š - ä¿¡å·äº§ç”Ÿç‡ä¸º0çš„å®Œæ•´è¯Šæ–­

**æ—¥æœŸ**: 2025-11-04
**å®¡è®¡èŒƒå›´**: setup.sh â†’ scanner â†’ analyze_symbol â†’ æ¦‚ç‡è®¡ç®— â†’ ä¿¡å·å‘å¸ƒ
**é—®é¢˜çº§åˆ«**: ğŸš¨ CRITICAL
**å½±å“**: æ‰«æ200å¸ç§äº§ç”Ÿ0ä¸ªä¿¡å·

---

## æ‰§è¡Œæ‘˜è¦

ç³»ç»Ÿå­˜åœ¨**å¤šå±‚çº§é…ç½®ä¸åŒ¹é…**é—®é¢˜ï¼Œå¯¼è‡´å³ä½¿ä¿®å¤äº†EVè®¡ç®—å’Œp_minè®¡ç®—ç¼ºé™·ï¼Œä¿¡å·ä»æ— æ³•é€šè¿‡anti-jitteré˜²æŠ–åŠ¨æœºåˆ¶çš„æ¦‚ç‡é—¨æ§›æ£€æŸ¥ã€‚

### æ ¸å¿ƒé—®é¢˜
```
æ¦‚ç‡æ˜ å°„äº§ç”Ÿ: P = 0.53-0.56 (53-56%)
     â†“
Anti-jitterè¦æ±‚: P â‰¥ 0.65 (65%)
     â†“
ç»“æœ: æ‰€æœ‰ä¿¡å·è¢«é™çº§ä¸ºWATCHï¼Œæ— æ³•è¾¾åˆ°PRIMEçº§åˆ«
     â†“
Scannerè¦æ±‚: new_level == 'PRIME' æ‰å‘å¸ƒ
     â†“
æœ€ç»ˆ: 0ä¸ªä¿¡å·å‘å¸ƒ
```

---

## å·²ä¿®å¤çš„é—®é¢˜ï¼ˆcommits 1507ca5, d511503, 4169049ï¼‰

### 1. EVè®¡ç®—ä½¿ç”¨æœ‰ç¬¦å·edge (âœ… å·²ä¿®å¤ - commit 1507ca5)

**æ–‡ä»¶**: `ats_core/pipeline/analyze_symbol.py:634`

**é—®é¢˜**: SHORTä¿¡å·çš„edgeä¸ºè´Ÿå€¼ï¼Œå¯¼è‡´ `P * edge` ä¸ºè´Ÿï¼ŒEVæ€»æ˜¯â‰¤0

```python
# ä¿®å¤å‰ (é”™è¯¯)
EV = P_chosen * edge - (1 - P_chosen) * cost

# ä¿®å¤å (æ­£ç¡®)
EV = P_chosen * abs(edge) - (1 - P_chosen) * cost
```

**å½±å“**: æ‰€æœ‰SHORTä¿¡å·è¢«EVâ‰¤0è¿‡æ»¤

---

### 2. gates_evæ˜¾ç¤ºè®¡ç®—é”™è¯¯ (âœ… å·²ä¿®å¤ - commit d511503)

**æ–‡ä»¶**: `ats_core/pipeline/analyze_symbol.py:725`

**é—®é¢˜**: ä½¿ç”¨ç®€åŒ–å…¬å¼å‡è®¾edge=1.0

```python
# ä¿®å¤å‰
gates_ev = 2 * P_chosen - 1 - cost

# ä¿®å¤å
gates_ev = P_chosen * abs(edge) - (1 - P_chosen) * cost
```

**å½±å“**: "å››é—¨è°ƒèŠ‚"è¾“å‡ºçš„EVå€¼ä¸å‡†ç¡®

---

### 3. p_minåŠ¨æ€è°ƒæ•´è¿‡ä¸¥ (âœ… å·²ä¿®å¤ - commit 4169049)

**æ–‡ä»¶**: `ats_core/pipeline/analyze_symbol.py:647-649`

**é—®é¢˜**: `safety_margin / abs(edge)` å¯¹å°edgeäº§ç”Ÿè¿‡å¤§è°ƒæ•´ï¼ˆ0.04-0.06ï¼‰

```python
# ä¿®å¤å‰
p_min = base_p_min + safety_margin / (abs(edge) + 1e-6)
# edge=0.11 â†’ p_min=0.624

# ä¿®å¤å
adjustment = safety_margin / (abs(edge) + 1e-6)
adjustment = min(adjustment, 0.02)  # é™åˆ¶æœ€å¤§è°ƒæ•´
p_min = base_p_min + adjustment
# edge=0.11 â†’ p_min=0.60
```

**å½±å“**: p_minè¿‡é«˜ï¼ˆ0.60-0.64ï¼‰å¯¼è‡´P<0.60ä¿¡å·è¢«è½¯çº¦æŸæ ‡è®°

---

### 4. Scannerè¯»å–EVå­—æ®µå¤§å°å†™é”™è¯¯ (âœ… å·²ä¿®å¤ - æœ¬æ¬¡)

**æ–‡ä»¶**: `scripts/realtime_signal_scanner.py:269`

**é—®é¢˜**: analyze_symbolå­˜å‚¨å¤§å†™'EV'ï¼Œscannerè¯»å–å°å†™'ev'

```python
# ä¿®å¤å‰
ev = publish_info.get('ev', 0.0)  # æ€»æ˜¯è¿”å›é»˜è®¤å€¼0.0

# ä¿®å¤å
ev = publish_info.get('EV', 0.0)  # æ­£ç¡®è¯»å–
```

**å½±å“**: Anti-jitteræ£€æŸ¥æ—¶evå§‹ç»ˆä¸º0ï¼Œå¯¼è‡´`ev > 0`æ¡ä»¶å¤±è´¥ï¼Œæ— æ³•è¾¾åˆ°PRIMEçº§åˆ«

---

## å½“å‰å‰©ä½™çš„æ ¸å¿ƒé—®é¢˜

### ğŸ”´ é—®é¢˜5: Anti-Jitteræ¦‚ç‡é˜ˆå€¼ä¸æ¦‚ç‡æ˜ å°„è¾“å‡ºä¸åŒ¹é…

#### é—®é¢˜åˆ†æ

**æ¦‚ç‡ç”Ÿæˆæµç¨‹**:

```
1. analyze_symbol.py:
   weighted_score = 11-16 (åŠ æƒè¯„åˆ† -100åˆ°+100)
   edge = weighted_score / 100 = 0.11-0.16

2. probability_v2.py (Sigmoidæ˜ å°„):
   P = sigmoid(edge, temperature=3.0, Q=1.0)

   edge=0.11 â†’ P â‰ˆ 0.55
   edge=0.13 â†’ P â‰ˆ 0.56
   edge=0.16 â†’ P â‰ˆ 0.58

3. realtime_signal_scanner.py (Anti-Jitteræ£€æŸ¥):
   prime_entry_threshold = 0.65 (65%)

   P=0.55 < 0.65 â†’ new_level = 'WATCH' æˆ– 'IGNORE'
   P=0.56 < 0.65 â†’ new_level = 'WATCH' æˆ– 'IGNORE'
   P=0.58 < 0.65 â†’ new_level = 'WATCH' æˆ– 'IGNORE'

4. Scannerå‘å¸ƒæ¡ä»¶:
   if new_level == 'PRIME':  # âŒ æ°¸è¿œä¸æ»¡è¶³
       publish()
```

#### å®é™…æ¡ˆä¾‹

ä»ç”¨æˆ·æµ‹è¯•æ•°æ®:

| å¸ç§ | weighted_score | edge | P_chosen | Anti-Jitterè¦æ±‚ | ç»“æœ |
|-----|---------------|------|----------|----------------|------|
| RENDERUSDT | ~11 | 0.1141 | 0.552 | Pâ‰¥0.65 | âŒ WATCH |
| GUSDT | ~13 | 0.1271 | 0.551 | Pâ‰¥0.65 | âŒ WATCH |
| INJUSDT | ~16 | 0.1622 | 0.535 | Pâ‰¥0.65 | âŒ WATCH |
| HMSTRUSDT | ~8 | 0.0834 | 0.566 | Pâ‰¥0.65 | âŒ WATCH |

**ç»“è®º**: æ‰€æœ‰ä¿¡å·çš„æ¦‚ç‡éƒ½åœ¨0.53-0.58èŒƒå›´ï¼Œæ— æ³•è¾¾åˆ°0.65é—¨æ§›

#### æ ¹æœ¬åŸå› 

**é…ç½®ä¸åŒ¹é…**:
- Anti-jitteré˜ˆå€¼è®¾å®šï¼ˆ0.65ï¼‰åŸºäº**ç†æƒ³å‡è®¾**
- å®é™…æ¦‚ç‡æ˜ å°„äº§ç”Ÿçš„æ˜¯**è¾ƒä¿å®ˆçš„å€¼**ï¼ˆ0.53-0.58ï¼‰
- Sigmoidå‡½æ•°åœ¨temperature=3.0æ—¶ï¼Œéœ€è¦edgeâ‰¥0.25æ‰èƒ½äº§ç”ŸPâ‰¥0.65

**ç†è®ºè®¡ç®—éªŒè¯**:
```python
# è¦è¾¾åˆ°P=0.65ï¼Œéœ€è¦çš„edgeå€¼ï¼š
# P = 1 / (1 + exp(-(prior_logit + temp * edge * Q)))
# 0.65 = 1 / (1 + exp(-(0 + 3 * edge * 1)))
# è§£å¾—: edge â‰ˆ 0.21

# è€Œå®é™…edgeåªæœ‰0.11-0.16ï¼Œè¿œå°äº0.21ï¼
```

---

## æ ¹æœ¬åŸå› æ€»ç»“

ç³»ç»Ÿè®¾è®¡ä¸­å­˜åœ¨**å‚æ•°é“¾æ¡ä¸ä¸€è‡´**:

```
è¯„åˆ†ç³»ç»Ÿ â†’ æ¦‚ç‡æ˜ å°„ â†’ Anti-Jitter â†’ Scanner
(-100~+100) â†’ (Sigmoid) â†’ (é˜ˆå€¼0.65) â†’ (è¦æ±‚PRIME)
    â†“          â†“            â†“              â†“
  å®é™…: 11-16  å®é™…: 0.53-0.58  æœŸæœ›: â‰¥0.65   ç»“æœ: 0ä¿¡å·
```

**é—®é¢˜æœ¬è´¨**: ä¸­é—´ç¯èŠ‚çš„è¾“å‡ºä¸ä¸‹æ¸¸ç¯èŠ‚çš„è¾“å…¥æœŸæœ›ä¸åŒ¹é…

---

## è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆA: è°ƒæ•´Anti-Jitteré˜ˆå€¼ (æ¨è - æœ€ç›´æ¥)

**æ–‡ä»¶**: `scripts/realtime_signal_scanner.py:151-159`

```python
# ä¿®æ”¹å‰
self.anti_jitter = AntiJitter(
    prime_entry_threshold=0.65,      # âŒ å¤ªé«˜
    prime_maintain_threshold=0.58,
    ...
)

# ä¿®æ”¹å
self.anti_jitter = AntiJitter(
    prime_entry_threshold=0.55,      # âœ… åŒ¹é…å®é™…æ¦‚ç‡èŒƒå›´
    prime_maintain_threshold=0.52,   # âœ… ç›¸åº”é™ä½ç»´æŒé˜ˆå€¼
    watch_entry_threshold=0.50,
    watch_maintain_threshold=0.45,
    confirmation_bars=1,
    total_bars=2,
    cooldown_seconds=60
)
```

**æ•ˆæœ**:
- RENDERUSDT (P=0.552) â†’ âœ… è¾¾åˆ°PRIME
- GUSDT (P=0.551) â†’ âœ… è¾¾åˆ°PRIME
- HMSTRUSDT (P=0.566) â†’ âœ… è¾¾åˆ°PRIME
- INJUSDT (P=0.535) â†’ âŒ ä»ç•¥ä½ï¼ˆä½†æ¥è¿‘ï¼‰

**é¢„æœŸ**: æ‰«æ200å¸ç§ â†’ 10-30ä¸ªä¿¡å·

---

### æ–¹æ¡ˆB: è°ƒæ•´Sigmoidæ¸©åº¦å‚æ•° (è¾ƒæ¿€è¿›)

**æ–‡ä»¶**: `ats_core/pipeline/analyze_symbol.py:611`

```python
# ä¿®æ”¹å‰
temperature = modulator_output.Teff_final  # é€šå¸¸ â‰ˆ 3.0

# ä¿®æ”¹å
temperature = modulator_output.Teff_final * 1.5  # æå‡50%ï¼Œæ›´æ¿€è¿›
```

**æ•ˆæœ**:
- edge=0.11, temp=4.5 â†’ P â‰ˆ 0.62
- edge=0.13, temp=4.5 â†’ P â‰ˆ 0.65 âœ…
- edge=0.16, temp=4.5 â†’ P â‰ˆ 0.69 âœ…

**é£é™©**: å¯èƒ½å¢åŠ å‡é˜³æ€§ï¼ˆè¯¯æŠ¥ï¼‰

---

### æ–¹æ¡ˆC: ç»„åˆè°ƒæ•´ (æœ€å¹³è¡¡)

1. **æ¸©å’Œæå‡æ¸©åº¦** (20%): `temperature * 1.2`
   - edge=0.13 â†’ P â‰ˆ 0.59

2. **é€‚åº¦é™ä½é˜ˆå€¼**: `prime_entry_threshold=0.58`

**æ•ˆæœ**: è¾¾åˆ°å¹³è¡¡ï¼Œä¿æŒç³»ç»Ÿä¿å®ˆæ€§åŒæ—¶æ¢å¤å¯ç”¨æ€§

---

## å»ºè®®çš„ä¿®å¤ä¼˜å…ˆçº§

### ç«‹å³æ‰§è¡Œ (P0)
1. âœ… **æ–¹æ¡ˆA**: è°ƒæ•´anti-jitteré˜ˆå€¼åˆ°0.55/0.52
   - æ–‡ä»¶: `scripts/realtime_signal_scanner.py:152-153`
   - éš¾åº¦: â­ (æ”¹2è¡Œé…ç½®)
   - é£é™©: ä½ï¼ˆä»…æ”¾å®½è¿‡æ»¤æ¡ä»¶ï¼‰

### åç»­ä¼˜åŒ– (P1)
2. **æ–¹æ¡ˆC**: å¦‚æœæ–¹æ¡ˆAæ•ˆæœä¸ç†æƒ³ï¼Œè€ƒè™‘ç»„åˆè°ƒæ•´
3. **ç›‘æ§**: è§‚å¯Ÿä¿¡å·è´¨é‡ï¼Œå¦‚æœè¯¯æŠ¥ç‡é«˜åˆ™å›è°ƒé˜ˆå€¼

### é•¿æœŸæ”¹è¿› (P2)
- æ·»åŠ è‡ªåŠ¨æ ¡å‡†æœºåˆ¶ï¼šæ ¹æ®å†å²æ¦‚ç‡åˆ†å¸ƒåŠ¨æ€è°ƒæ•´é˜ˆå€¼
- å®ç°A/Bæµ‹è¯•æ¡†æ¶ï¼šå¯¹æ¯”ä¸åŒå‚æ•°ç»„åˆçš„å®ç›˜æ•ˆæœ

---

## æµ‹è¯•éªŒè¯è®¡åˆ’

### ç¬¬ä¸€æ­¥: åº”ç”¨æ–¹æ¡ˆA

```bash
# 1. ä¿®æ”¹anti-jitteré˜ˆå€¼
cd ~/cryptosignal
# (ä½¿ç”¨Editå·¥å…·ä¿®æ”¹ scripts/realtime_signal_scanner.py)

# 2. æäº¤ä¿®å¤
git add scripts/realtime_signal_scanner.py
git commit -m "fix: è°ƒæ•´anti-jitteré˜ˆå€¼åŒ¹é…å®é™…æ¦‚ç‡åˆ†å¸ƒèŒƒå›´

- prime_entryä»0.65é™è‡³0.55
- prime_maintainä»0.58é™è‡³0.52
- è§£å†³æ¦‚ç‡æ˜ å°„è¾“å‡ºä¸anti-jitterè¦æ±‚ä¸åŒ¹é…é—®é¢˜
- é¢„æœŸæ¢å¤ä¿¡å·äº§ç”Ÿç‡è‡³æ­£å¸¸æ°´å¹³"

# 3. é‡å¯ç³»ç»Ÿæµ‹è¯•
./auto_restart.sh
```

### ç¬¬äºŒæ­¥: è§‚å¯Ÿç»“æœ

**æœŸæœ›è¾“å‡º**:
```
ğŸ“Š æ‰«æç»“æœ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   æ€»æ‰«æ: 200 ä¸ªå¸ç§
   å‘ç°ä¿¡å·: 45 ä¸ª
   Primeä¿¡å·: 12 ä¸ª  # âœ… ä¸å†æ˜¯0
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

**éªŒè¯æŒ‡æ ‡**:
- Primeä¿¡å·æ•° > 0 âœ…
- æ¦‚ç‡åˆ†å¸ƒåœ¨0.52-0.70ä¹‹é—´ âœ…
- EV > 0 âœ…
- æ— ç³»ç»Ÿæ€§åå‘ï¼ˆLONG/SHORTæ¯”ä¾‹å¹³è¡¡ï¼‰âœ…

---

## æŠ€æœ¯å€ºåŠ¡

### éœ€è¦åç»­è§£å†³çš„é—®é¢˜

1. **å‚æ•°æ ¡å‡†æ¡†æ¶ç¼ºå¤±**
   - å½“å‰é˜ˆå€¼éƒ½æ˜¯ç¡¬ç¼–ç 
   - ç¼ºä¹æ•°æ®é©±åŠ¨çš„å‚æ•°ä¼˜åŒ–æœºåˆ¶

2. **æ¦‚ç‡æ˜ å°„ä¸è¯„åˆ†ç³»ç»Ÿè€¦åˆåº¦é«˜**
   - weighted_score â†’ edge â†’ probability é“¾æ¡è„†å¼±
   - ä»»ä½•ä¸€ç¯è°ƒæ•´éƒ½ä¼šå½±å“ä¸‹æ¸¸

3. **æ–‡æ¡£ä¸å®ç°ä¸ä¸€è‡´**
   - PUBLISHING.mdè§„èŒƒä¸­çš„é˜ˆå€¼ä¸å®é™…ä»£ç ä¸åŒ¹é…
   - éœ€è¦æ›´æ–°è§„èŒƒæ–‡æ¡£

---

## é™„å½•: å…³é”®ä»£ç ä½ç½®

| ç»„ä»¶ | æ–‡ä»¶ | è¡Œå· | åŠŸèƒ½ |
|-----|------|-----|------|
| è¯„åˆ†ç³»ç»Ÿ | `ats_core/scoring/scorecard.py` | 1-58 | åŠ æƒå¹³å‡è®¡ç®— |
| æ¦‚ç‡æ˜ å°„ | `ats_core/scoring/probability_v2.py` | 17-74 | Sigmoidæ˜ å°„ |
| ä¿¡å·åˆ†æ | `ats_core/pipeline/analyze_symbol.py` | 600-1100 | å®Œæ•´åˆ†ææµç¨‹ |
| Anti-Jitter | `ats_core/publishing/anti_jitter.py` | 29-170 | é˜²æŠ–åŠ¨æœºåˆ¶ |
| Scanner | `scripts/realtime_signal_scanner.py` | 151-339 | ä¿¡å·æ‰«æå’Œå‘å¸ƒ |

---

## ç»“è®º

ç³»ç»Ÿçš„ä¿¡å·äº§ç”Ÿç‡ä¸º0æ˜¯**å¤šä¸ªå·²ä¿®å¤çš„bug**ä¸**ä¸€ä¸ªé…ç½®ä¸åŒ¹é…é—®é¢˜**å…±åŒä½œç”¨çš„ç»“æœ:

1. âœ… EVè®¡ç®—bug (å·²ä¿®å¤)
2. âœ… gates_evè®¡ç®—bug (å·²ä¿®å¤)
3. âœ… p_minè¿‡ä¸¥ (å·²ä¿®å¤)
4. âœ… Scanner EVå­—æ®µå¤§å°å†™ (å·²ä¿®å¤)
5. âŒ **Anti-Jitteré˜ˆå€¼ä¸æ¦‚ç‡æ˜ å°„è¾“å‡ºä¸åŒ¹é…** (å¾…ä¿®å¤)

**ç´§æ€¥ç¨‹åº¦**: ğŸ”¥ æœ€é«˜ä¼˜å…ˆçº§
**ä¿®å¤éš¾åº¦**: â­ æç®€å•ï¼ˆæ”¹2è¡Œé…ç½®ï¼‰
**å½±å“èŒƒå›´**: ğŸŒ å…¨å±€ï¼ˆæ‰€æœ‰ä¿¡å·å‘å¸ƒï¼‰
**é¢„æœŸæ•ˆæœ**: ç«‹å³æ¢å¤ç³»ç»Ÿä¿¡å·äº§ç”Ÿèƒ½åŠ›

---

**ä¸‹ä¸€æ­¥**: ç«‹å³åº”ç”¨æ–¹æ¡ˆAï¼Œè°ƒæ•´anti-jitteré˜ˆå€¼åˆ°0.55/0.52
