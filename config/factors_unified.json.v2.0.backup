{
  "version": "2.0.0",
  "updated_at": "2025-10-27",
  "description": "统一因子参数配置（10+1维有机整合）",

  "factors": {
    "T": {
      "name": "Trend",
      "layer": "price_action",
      "weight": 25,
      "enabled": true,
      "description": "趋势强度（EMA交叉+斜率）",
      "params": {
        "ema_short": 10,
        "ema_long": 50,
        "atr_period": 14,
        "slope_window": 20
      }
    },

    "M": {
      "name": "Momentum",
      "layer": "price_action",
      "weight": 15,
      "enabled": true,
      "description": "价格动量（加速度）",
      "params": {
        "lookback_periods": 20,
        "acceleration_window": 10,
        "stable_supply_boost_enabled": false,
        "stable_supply_boost_weight": 0.2
      }
    },

    "C+": {
      "name": "Enhanced CVD",
      "layer": "money_flow",
      "weight": 20,
      "enabled": true,
      "description": "增强CVD（动态权重+EMA平滑）",
      "params": {
        "ema_period": 12,
        "zscore_window": 60,
        "dynamic_weight": true,
        "cross_exchange_enabled": false,
        "cross_exchange_symbols": ["BTCUSDT", "ETHUSDT"],
        "cross_exchange_weight": 0.3
      }
    },

    "S": {
      "name": "Structure",
      "layer": "price_action",
      "weight": 10,
      "enabled": true,
      "description": "支撑阻力结构质量",
      "params": {
        "pivot_lookback": 20,
        "min_touches": 2,
        "tolerance_atr": 0.5
      }
    },

    "V+": {
      "name": "Volume + Trigger",
      "layer": "price_action",
      "weight": 15,
      "enabled": true,
      "description": "成交量放大+触发K检测",
      "params": {
        "volume_zscore_window": 20,
        "volume_weight": 0.6,
        "trigger_weight": 0.4,
        "trigger_body_ratio_min": 0.6,
        "trigger_breakthrough_atr_mult": 0.25,
        "trigger_volume_mult_min": 1.5
      }
    },

    "O+": {
      "name": "OI Regime",
      "layer": "money_flow",
      "weight": 20,
      "enabled": true,
      "description": "OI四象限体制识别",
      "params": {
        "regime_window_hours": 12,
        "delta_threshold_pct": 0.05,
        "oi_level_high_threshold": 1.3,
        "oi_level_window_hours": 168,
        "regime_weights": {
          "up_up": 1.0,
          "up_dn": 0.3,
          "dn_up": -1.0,
          "dn_dn": -0.3
        },
        "strength_multiplier": 1.5
      }
    },

    "L": {
      "name": "Liquidity",
      "layer": "microstructure",
      "weight": 20,
      "enabled": true,
      "description": "流动性质量（订单簿深度）",
      "params": {
        "spread_good_bps": 2.0,
        "spread_bad_bps": 10.0,
        "depth_target_usdt": 1000000,
        "impact_notional_usdt": 100000,
        "impact_max_pct": 0.01,
        "orderbook_depth_levels": 10,
        "spread_weight": 0.3,
        "depth_weight": 0.3,
        "impact_weight": 0.3,
        "obi_weight": 0.1,
        "ldi_enabled": false,
        "ldi_penalty_max": 20
      }
    },

    "B": {
      "name": "Basis + Funding",
      "layer": "microstructure",
      "weight": 15,
      "enabled": true,
      "description": "基差+资金费（市场情绪）",
      "params": {
        "basis_neutral_bps": 50,
        "basis_extreme_bps": 100,
        "funding_neutral_rate": 0.001,
        "funding_extreme_rate": 0.002,
        "basis_weight": 0.6,
        "funding_weight": 0.4,
        "fwi_enabled": false,
        "fwi_window_minutes": 30,
        "fwi_boost_max": 20
      }
    },

    "Q": {
      "name": "Liquidation",
      "layer": "microstructure",
      "weight": 10,
      "enabled": true,
      "description": "清算密度倾斜（级联风险）",
      "params": {
        "interval_minutes": 5,
        "zscore_window_hours": 1,
        "lti_multiplier": 50,
        "wall_detection_enabled": true,
        "wall_min_volume_usdt": 1000000,
        "wall_cluster_pct": 0.02
      }
    },

    "I": {
      "name": "Independence",
      "layer": "market_context",
      "weight": 10,
      "enabled": true,
      "description": "独立性评分（vs BTC/ETH）",
      "params": {
        "window_hours": 24,
        "beta_threshold_high": 1.5,
        "beta_threshold_low": 0.5,
        "regression_method": "ols",
        "btc_weight": 0.6,
        "eth_weight": 0.4
      }
    },

    "F": {
      "name": "Fund Leading",
      "type": "regulator",
      "layer": "money_flow",
      "enabled": true,
      "description": "资金领先性调节器",
      "params": {
        "adjustment_min": 0.85,
        "adjustment_max": 1.15,
        "cvd_threshold": 1.5,
        "alignment_bonus": 0.05
      }
    }
  },

  "weights_config": {
    "total_weight": 160,
    "normalization_factor": 1.6,
    "layer_distribution": {
      "price_action": 65,
      "money_flow": 40,
      "microstructure": 45,
      "market_context": 10
    }
  },

  "adaptive_weights": {
    "enabled": false,
    "blend_ratio": 0.7,
    "regimes": {
      "strong_trend": {
        "condition": "abs(market_regime) > 60",
        "description": "强趋势市场",
        "weight_adjustments": {
          "T": 30,
          "C+": 25,
          "O+": 25,
          "L": 15,
          "B": 10,
          "M": 15,
          "S": 10,
          "V+": 15,
          "Q": 10,
          "I": 10
        }
      },
      "choppy": {
        "condition": "abs(market_regime) < 30",
        "description": "震荡市场",
        "weight_adjustments": {
          "T": 20,
          "S": 15,
          "L": 25,
          "B": 20,
          "M": 15,
          "C+": 15,
          "O+": 15,
          "V+": 15,
          "Q": 10,
          "I": 10
        }
      },
      "high_volatility": {
        "condition": "volatility > 0.05",
        "description": "高波动市场",
        "weight_adjustments": {
          "Q": 15,
          "T": 20,
          "M": 15,
          "C+": 20,
          "S": 10,
          "V+": 15,
          "O+": 20,
          "L": 20,
          "B": 15,
          "I": 10
        }
      }
    }
  },

  "thresholds": {
    "prime_strength_min": 65,
    "prime_prob_min": 0.62,
    "watch_strength_min": 55,
    "watch_prob_min": 0.55,

    "filters": {
      "liquidity_min": 70,
      "liquidity_warn": 60,
      "independence_min": 30,
      "basis_extreme_bps": 100,
      "funding_extreme_rate": 0.002,
      "oi_level_max": 1.5,
      "obi_min_long": 0.1,
      "obi_max_short": -0.1,
      "liquidation_wall_distance_min_pct": 0.01
    },

    "adjustments": {
      "funding_extreme_prob_discount": 0.85,
      "funding_extreme_strength_discount": 0.90,
      "basis_extreme_tp_discount": 0.90,
      "low_liquidity_sl_multiplier": 2.5,
      "high_liquidity_sl_multiplier": 1.8
    }
  },

  "risk_management": {
    "stop_loss": {
      "base_atr_multiplier": 1.8,
      "liquidity_adaptive": true,
      "liquidity_thresholds": {
        "low": 60,
        "medium": 80,
        "high": 90
      },
      "liquidity_multipliers": {
        "low": 2.5,
        "medium": 2.0,
        "high": 1.8
      }
    },

    "take_profit": {
      "base_atr_multiplier": 2.5,
      "tp1_ratio": 1.0,
      "tp2_ratio": 1.5,
      "liquidation_wall_enabled": true,
      "liquidation_wall_buffer_pct": 0.02,
      "basis_adjustment_enabled": true,
      "basis_threshold_bps": 50,
      "basis_discount": 0.90
    },

    "position_sizing": {
      "liquidity_based": true,
      "min_size_pct": 1.0,
      "max_size_pct": 5.0,
      "liquidity_multiplier": 0.05
    }
  },

  "data_sources": {
    "klines": {
      "timeframes": ["1h", "4h"],
      "limits": {
        "1h": 200,
        "4h": 100
      }
    },
    "orderbook": {
      "enabled": true,
      "depth_levels": 20,
      "update_interval_sec": 5
    },
    "liquidations": {
      "enabled": true,
      "sources": ["binance"],
      "interval_minutes": 5
    },
    "funding_rate": {
      "enabled": true,
      "update_interval_hours": 8
    }
  },

  "evaluation": {
    "factor_correlation": {
      "max_threshold": 0.5,
      "high_threshold": 0.7,
      "check_interval_days": 7
    },
    "out_of_sample": {
      "test_ratio": 0.2,
      "min_train_days": 90,
      "decay_threshold_pct": 0.30
    },
    "ic_monitoring": {
      "ic_min": 0.05,
      "ic_win_rate_min": 0.55,
      "ic_stability_max": 2.0
    }
  }
}
