# æ–°å¸åˆ†ææ–­å±‚é—®é¢˜åˆ†æ

**åˆ†ææ—¥æœŸ**: 2025-11-12
**ç‰ˆæœ¬**: v7.2.30

## é—®é¢˜æ¦‚è¿°

æ–°å¸åˆ†ææµç¨‹ä¸­å­˜åœ¨å¤šä¸ª"æ–­å±‚"ï¼ˆGapï¼‰é—®é¢˜ï¼Œå³åœ¨æŸäº›ä¸´ç•Œç‚¹å‡ºç°çªå˜ï¼Œè€Œéå¹³æ»‘è¿‡æ¸¡ã€‚è¿™å¯èƒ½å¯¼è‡´ï¼š
- bars=199 vs bars=201 çš„å¸ç§å¾—åˆ°å®Œå…¨ä¸åŒçš„å¤„ç†
- é˜¶æ®µåˆ‡æ¢æ—¶é˜ˆå€¼çªå˜
- ä¿¡å·æ•°é‡åœ¨ä¸´ç•Œç‚¹å‰§çƒˆæ³¢åŠ¨

---

## 1. ç¡¬é—¨æ§›æ–­å±‚ï¼ˆæœ€ä¸¥é‡ï¼‰

### é—®é¢˜æè¿°

**ä½ç½®**: `analyze_symbol.py:186-205`

```python
# ç¡¬æ‹’ç»ï¼šDataQual < data_qual_min
if data_qual < data_qual_min:
    return {
        "success": False,
        "error": f"æ•°æ®è´¨é‡ä¸è¶³: DataQual={data_qual:.2f}"
    }
```

### æ–­å±‚è¡¨ç°

| bars_1h | data_qual | ç»“æœ |
|---------|-----------|------|
| 179 | 0.895 | âŒ **ç›´æ¥æ‹’ç»**ï¼ˆ<0.90ï¼‰ |
| 180 | 0.900 | âœ… ç»§ç»­åˆ†æ |
| 181 | 0.905 | âœ… ç»§ç»­åˆ†æ |

**å½±å“**ï¼š
- bars=179ï¼šå®Œå…¨è¢«æ‹’ç»ï¼Œæ— æ³•è¿›å…¥åˆ†ææµç¨‹
- bars=180ï¼šçªç„¶å…è®¸åˆ†æ
- **æ–­å´–æ•ˆåº”**ï¼šå·®1æ ¹Kçº¿ï¼ˆ1å°æ—¶ï¼‰å°±å®Œå…¨ä¸åŒ

### é£é™©è¯„ä¼°

ğŸ”´ **é«˜é£é™©**
- æ–°å¸ä¸Šå¸‚åéœ€è¦7.5å¤©ï¼ˆ180å°æ—¶ï¼‰æ‰èƒ½é€šè¿‡ç¡¬é—¨æ§›
- é”™è¿‡æ–°å¸æœ€åˆçš„æ³¢åŠ¨æœºä¼š
- bars=179å’Œbars=180ä¹‹é—´å·®å¼‚è¿‡å¤§

### å»ºè®®æ–¹æ¡ˆ

**æ–¹æ¡ˆAï¼šè½¯åŒ–ç¡¬é—¨æ§›ï¼ˆæ¨èï¼‰**
```python
# æ”¹ä¸ºè½¯é—¨æ§›+é™çº§å¤„ç†
if data_qual < 0.90:
    # ä¸ç›´æ¥æ‹’ç»ï¼Œè€Œæ˜¯æ ‡è®°ä¸º"æ•°æ®è´¨é‡è­¦å‘Š"
    data_quality_warning = True
    # å¯¹confidenceåº”ç”¨é¢å¤–æƒ©ç½š
    quality_penalty = (0.90 - data_qual) * 50  # ä¾‹å¦‚ï¼š0.88 â†’ æƒ©ç½š1åˆ†
```

**æ–¹æ¡ˆBï¼šé™ä½ç¡¬é—¨æ§›**
```python
# é™ä½è‡³0.85ï¼ˆ170æ ¹Kçº¿ = 7.1å¤©ï¼‰
data_qual_min = 0.85
```

**æ–¹æ¡ˆCï¼šæ–°å¸è±å…**
```python
# æ–°å¸ä½¿ç”¨æ›´ä½çš„é—¨æ§›
if is_new_coin:
    data_qual_min = 0.75  # 150æ ¹Kçº¿ = 6.25å¤©
else:
    data_qual_min = 0.90
```

---

## 2. é˜¶æ®µåˆ‡æ¢æ–­å±‚

### é—®é¢˜æè¿°

**ä½ç½®**: `analyze_symbol.py:248-306`

æ–°å¸é˜¶æ®µæŒ‰bars_1hç¡¬åˆ‡æ¢ï¼š

```python
if bars_1h < 24:  # < 1å¤©
    coin_phase = "newcoin_ultra"
elif bars_1h < 168:  # < 7å¤©
    coin_phase = "newcoin_phaseA"
elif bars_1h < 400:  # < 16.7å¤©
    coin_phase = "newcoin_phaseB"
else:
    coin_phase = "mature"
```

### æ–­å±‚è¡¨ç°

#### æ–­å±‚1ï¼šultra â†’ phaseAï¼ˆbars=24ï¼‰

| bars_1h | coin_phase | confidence_min | edge_min |
|---------|------------|----------------|----------|
| 23 | ultra | 70 | 0.60 |
| **24** | **phaseA** | **65 (â†“5)** | **0.55 (â†“0.05)** |
| 25 | phaseA | 65 | 0.55 |

**å½±å“**ï¼š
- confidence_min çªé™5åˆ†ï¼ˆ7.1%ï¼‰
- edge_min çªé™0.05ï¼ˆ8.3%ï¼‰

#### æ–­å±‚2ï¼šphaseA â†’ phaseBï¼ˆbars=168ï¼‰

| bars_1h | coin_phase | confidence_min | edge_min |
|---------|------------|----------------|----------|
| 167 | phaseA | 65 | 0.55 |
| **168** | **phaseB** | **60 (â†“5)** | **0.50 (â†“0.05)** |
| 169 | phaseB | 60 | 0.50 |

**å½±å“**ï¼šåŒä¸Š

#### æ–­å±‚3ï¼šphaseB â†’ matureï¼ˆbars=400ï¼Œæœ€ä¸¥é‡ï¼‰

| bars_1h | coin_phase | confidence_min | edge_min |
|---------|------------|----------------|----------|
| 399 | phaseB | 60 | 0.50 |
| **400** | **mature** | **15 (â†“45)** | **0.12 (â†“0.38)** |
| 401 | mature | 15 | 0.12 |

**å½±å“**ï¼š
- confidence_min **æš´è·Œ45åˆ†**ï¼ˆ75%ï¼‰
- edge_min **æš´è·Œ0.38**ï¼ˆ76%ï¼‰
- **ä¿¡å·æ•°é‡å¯èƒ½æš´æ¶¨æ•°å€**

### é£é™©è¯„ä¼°

ğŸ”´ **é«˜é£é™©**ï¼ˆæ–­å±‚3ï¼‰
ğŸŸ¡ **ä¸­é£é™©**ï¼ˆæ–­å±‚1ã€2ï¼‰

### å»ºè®®æ–¹æ¡ˆ

**æ–¹æ¡ˆAï¼šçº¿æ€§è¿‡æ¸¡ï¼ˆæ¨èï¼‰**

åœ¨é˜¶æ®µåˆ‡æ¢å‰åå¼•å…¥è¿‡æ¸¡æœŸï¼ˆä¾‹å¦‚Â±24å°æ—¶ï¼‰ï¼š

```python
# é˜¶æ®µ3ï¼šphaseB â†’ mature è¿‡æ¸¡æœŸï¼ˆ376-424å°æ—¶ï¼‰
transition_start = 376  # 400-24
transition_end = 424    # 400+24

if bars_1h < transition_start:
    confidence_min = 60  # phaseB
elif bars_1h < transition_end:
    # çº¿æ€§æ’å€¼
    ratio = (bars_1h - transition_start) / (transition_end - transition_start)
    confidence_min = 60 - ratio * (60 - 15)  # 60 â†’ 15
else:
    confidence_min = 15  # mature
```

**æ–¹æ¡ˆBï¼šå¢åŠ è¿‡æ¸¡é˜¶æ®µ**

æ·»åŠ æ–°é˜¶æ®µï¼šphaseCï¼ˆ400-600å°æ—¶ï¼‰ï¼Œä½¿ç”¨ä¸­é—´é˜ˆå€¼ï¼š
- confidence_min = 35ï¼ˆä»‹äº60å’Œ15ä¹‹é—´ï¼‰
- edge_min = 0.30ï¼ˆä»‹äº0.50å’Œ0.12ä¹‹é—´ï¼‰

**æ–¹æ¡ˆCï¼šä¿æŒç°çŠ¶ï¼Œæ–‡æ¡£åŒ–**

å¦‚æœè®¤ä¸ºæ–­å±‚æ˜¯åˆç†çš„ï¼ˆä½“ç°æ•°æ®ç§¯ç´¯çš„è´¨å˜ï¼‰ï¼Œåˆ™åœ¨æ–‡æ¡£ä¸­æ˜ç¡®è¯´æ˜ï¼š
- æ–°å¸é˜ˆå€¼ä¸¥æ ¼æ˜¯ä¸ºäº†ä¿æŠ¤ç”¨æˆ·
- bars=400æ˜¯ç»è¿‡æ•°æ®éªŒè¯çš„æˆç†Ÿæ ‡å‡†
- é˜ˆå€¼çªé™åæ˜ æ•°æ®å¯é æ€§è´¨å˜

---

## 3. è´¨é‡è¡¥å¿æ–­å±‚

### é—®é¢˜æè¿°

**ä½ç½®**: `analyze_symbol.py:635-649`

```python
if is_new_coin and len(k1) < 100:
    # è¡¥å¿é€»è¾‘...
    if is_ultra_new:
        quality_score = min(1.0, quality_score / 0.85 * 0.90)
    # ...
```

### æ–­å±‚è¡¨ç°

| bars_1h | is_new_coin | qualityè¡¥å¿ | å®é™…qualityï¼ˆå‡è®¾åŸå€¼0.85ï¼‰ |
|---------|-------------|-------------|----------------------------|
| 99 | âœ“ (phaseA) | âœ“ | 0.88 |
| **100** | **âœ“ (phaseA)** | **âœ—ï¼ˆæ¶ˆå¤±ï¼‰** | **0.85** |
| 101 | âœ“ (phaseA) | âœ— | 0.85 |

**å½±å“**ï¼š
- bars=100æ—¶è¡¥å¿çªç„¶æ¶ˆå¤±
- quality_score çªé™3%ï¼ˆ0.88 â†’ 0.85ï¼‰

### é£é™©è¯„ä¼°

ğŸŸ¡ **ä¸­é£é™©**

### å»ºè®®æ–¹æ¡ˆ

**æ–¹æ¡ˆAï¼šå»¶é•¿è¡¥å¿èŒƒå›´**

```python
if is_new_coin and len(k1) < 200:  # 100 â†’ 200
    # è¡¥å¿é€»è¾‘...
```

**æ–¹æ¡ˆBï¼šå¹³æ»‘é€€å‡º**

```python
if is_new_coin and len(k1) < 150:
    if len(k1) < 100:
        # å®Œå…¨è¡¥å¿
        quality_score = quality_score / 0.85 * 0.90
    else:
        # çº¿æ€§é€€å‡ºï¼ˆ100-150ä¹‹é—´ï¼‰
        ratio = (len(k1) - 100) / 50.0
        compensate_to = 0.90 - ratio * (0.90 - 0.85)  # 0.90 â†’ 0.85
        quality_score = quality_score / 0.85 * compensate_to
```

---

## 4. v7.2.29åŠ¨æ€è°ƒæ•´æ–­å±‚

### é—®é¢˜æè¿°

**ä½ç½®**: `analyze_symbol_v72.py:252-298`

Få› å­åŠ¨æ€è°ƒæ•´ä½¿ç”¨çº¿æ€§æ’å€¼ï¼ˆF_threshold_min=35, F_threshold_max=60ï¼‰ï¼š

```python
if F_effective >= 60:
    confidence_min = base - 5  # å®Œå…¨é™ä½
elif F_effective >= 35:
    confidence_min = linear_reduce(F, 35, 60, base, base-5)  # çº¿æ€§
else:
    confidence_min = base  # æ— é™ä½
```

### æ–­å±‚è¡¨ç°

| F_effective | confidence_min (å‡è®¾base=15) |
|-------------|------------------------------|
| 34 | 15 |
| **35** | **15 â†’ 14.8** |
| 40 | 14.0 |
| 60 | 10 |
| **61** | **10ï¼ˆä¸å†é™ä½ï¼‰** |

**å½±å“**ï¼š
- F=34 vs F=35ï¼šçªç„¶å¼€å§‹é™ä½ï¼ˆä½†å¹…åº¦å°ï¼Œå½±å“æœ‰é™ï¼‰
- F=60 vs F=61ï¼šåœæ­¢é™ä½ï¼Œä½†å·²åœ¨æé™è“„åŠ¿åŒº

### é£é™©è¯„ä¼°

ğŸŸ¢ **ä½é£é™©**

v7.2.29çš„çº¿æ€§æ’å€¼å·²ç»å¾ˆå¥½åœ°è§£å†³äº†åŸæ¥çš„åˆ†çº§æ–­å±‚é—®é¢˜ã€‚å½“å‰æ–­å±‚ä¸»è¦åœ¨è¾¹ç•Œç‚¹ï¼Œå½±å“è¾ƒå°ã€‚

### å»ºè®®æ–¹æ¡ˆ

**æ–¹æ¡ˆï¼šå¼•å…¥Sigmoidå‡½æ•°ï¼ˆå¯é€‰ä¼˜åŒ–ï¼‰**

```python
def smooth_reduce(F, F_min, F_max, val_min, val_max):
    """ä½¿ç”¨Sigmoidå®ç°æ›´å¹³æ»‘çš„è¿‡æ¸¡"""
    if F <= F_min:
        return val_min
    if F >= F_max:
        return val_max

    # Sigmoidè¿‡æ¸¡
    x = (F - F_min) / (F_max - F_min)  # å½’ä¸€åŒ–åˆ°[0,1]
    sigmoid = 1 / (1 + math.exp(-10 * (x - 0.5)))  # ä¸­å¿ƒåœ¨0.5
    return val_min + sigmoid * (val_max - val_min)
```

---

## 5. æ–°å¸é…ç½®æ–­å±‚ï¼ˆv7.2.30å·²ä¿®å¤ï¼‰

### é—®é¢˜æè¿°ï¼ˆå·²ä¿®å¤ï¼‰

**ä¿®å¤å‰**ï¼š
- é…ç½®æ–‡ä»¶å®šä¹‰newcoin_ultra/phaseA/phaseBé˜ˆå€¼ï¼ˆ60/65/70ï¼‰
- ä»£ç æ€»æ˜¯ä½¿ç”¨matureé˜ˆå€¼ï¼ˆ15ï¼‰
- **é…ç½®å®Œå…¨æ— æ•ˆ**

**ä¿®å¤å**ï¼š
- ä½¿ç”¨`_get_threshold_by_phase()`æ ¹æ®coin_phaseè¯»å–å¯¹åº”é˜ˆå€¼
- æ–°å¸ä½¿ç”¨ä¸¥æ ¼é˜ˆå€¼ï¼Œæˆç†Ÿå¸ä½¿ç”¨å®½æ¾é˜ˆå€¼

### éªŒè¯æµ‹è¯•

| coin_phase | confidence_minï¼ˆä¿®å¤å‰ï¼‰ | confidence_minï¼ˆä¿®å¤åï¼‰ |
|------------|-------------------------|-------------------------|
| ultra | 15 | 70 âœ“ |
| phaseA | 15 | 65 âœ“ |
| phaseB | 15 | 60 âœ“ |
| mature | 15 | 15 âœ“ |

âœ… **å·²è§£å†³**

---

## 6. æ€»ç»“ä¸ä¼˜å…ˆçº§

### æ–­å±‚é—®é¢˜ä¼˜å…ˆçº§

| # | é—®é¢˜ | ä¸¥é‡æ€§ | ä¼˜å…ˆçº§ | çŠ¶æ€ |
|---|------|--------|--------|------|
| 1 | ç¡¬é—¨æ§›æ–­å±‚ï¼ˆbars=180ï¼‰ | ğŸ”´ é«˜ | P0 | å¾…è§£å†³ |
| 2 | phaseBâ†’matureæ–­å±‚ï¼ˆbars=400ï¼‰ | ğŸ”´ é«˜ | P0 | å¾…è§£å†³ |
| 3 | ultraâ†’phaseAæ–­å±‚ï¼ˆbars=24ï¼‰ | ğŸŸ¡ ä¸­ | P1 | å¾…è§£å†³ |
| 4 | phaseAâ†’phaseBæ–­å±‚ï¼ˆbars=168ï¼‰ | ğŸŸ¡ ä¸­ | P1 | å¾…è§£å†³ |
| 5 | è´¨é‡è¡¥å¿æ–­å±‚ï¼ˆbars=100ï¼‰ | ğŸŸ¡ ä¸­ | P2 | å¾…è§£å†³ |
| 6 | FåŠ¨æ€è°ƒæ•´è¾¹ç•Œ | ğŸŸ¢ ä½ | P3 | å¯é€‰ä¼˜åŒ– |
| 7 | æ–°å¸é…ç½®æ— æ•ˆ | ğŸ”´ é«˜ | P0 | âœ… v7.2.30å·²ä¿®å¤ |

### æ¨èä¿®å¤é¡ºåº

1. **P0-1: ç¡¬é—¨æ§›æ–­å±‚** - ä»data_qual=0.90é™è‡³0.85ï¼Œæˆ–æ”¹ä¸ºè½¯é—¨æ§›
2. **P0-2: phaseBâ†’matureæ–­å±‚** - å¼•å…¥è¿‡æ¸¡æœŸï¼ˆ376-424å°æ—¶ï¼‰æˆ–phaseCé˜¶æ®µ
3. **P1: ultra/phaseA/phaseBæ–­å±‚** - åœ¨å„é˜¶æ®µåˆ‡æ¢ç‚¹å¼•å…¥Â±24hè¿‡æ¸¡æœŸ
4. **P2: è´¨é‡è¡¥å¿æ–­å±‚** - å»¶é•¿è¡¥å¿èŒƒå›´è‡³bars<200ï¼Œæˆ–å¹³æ»‘é€€å‡º

### æ˜¯å¦éœ€è¦ä¿®å¤ï¼Ÿ

**å»ºè®®**ï¼š
- P0é—®é¢˜ï¼ˆ#1ã€#2ï¼‰åº”è¯¥ä¿®å¤ - å½±å“å¤§ï¼Œé£é™©é«˜
- P1é—®é¢˜ï¼ˆ#3ã€#4ï¼‰å¯é€‰ä¿®å¤ - å½±å“ä¸­ç­‰ï¼Œçœ‹å®é™…éœ€æ±‚
- P2é—®é¢˜ï¼ˆ#5ï¼‰å»ºè®®ä¿®å¤ - å®ç°ç®€å•ï¼Œæ”¶ç›Šæ˜æ˜¾
- P3é—®é¢˜ï¼ˆ#6ï¼‰æ— éœ€ä¿®å¤ - å½“å‰å·²è¶³å¤Ÿå¹³æ»‘

**æƒè¡¡è€ƒè™‘**ï¼š
1. **æ•°æ®å¯é æ€§ä¼˜å…ˆ**ï¼šå¦‚æœè®¤ä¸ºæ•°æ®ç§¯ç´¯å­˜åœ¨è´¨å˜ç‚¹ï¼Œæ–­å±‚æ˜¯åˆç†çš„
2. **ä¿¡å·å¹³æ»‘æ€§ä¼˜å…ˆ**ï¼šå¦‚æœè¿½æ±‚å¹³æ»‘è¿‡æ¸¡ï¼Œé¿å…ä¸´ç•Œç‚¹æ³¢åŠ¨ï¼Œåº”ä¿®å¤
3. **å·¥ç¨‹å¤æ‚åº¦**ï¼šå¼•å…¥è¿‡æ¸¡æœŸä¼šå¢åŠ ä»£ç å¤æ‚åº¦å’Œæµ‹è¯•æˆæœ¬

---

## é™„å½•ï¼šæ–­å±‚æ£€æµ‹è„šæœ¬

```python
def detect_gaps(bars_range=range(1, 500)):
    """æ£€æµ‹æ–°å¸åˆ†ææµç¨‹ä¸­çš„æ–­å±‚ç‚¹"""

    results = []
    prev_thresholds = None

    for bars in bars_range:
        # æ¨¡æ‹Ÿå¸é¾„åˆ¤æ–­
        if bars < 24:
            phase = 'ultra'
            conf_min = 70
            edge_min = 0.60
        elif bars < 168:
            phase = 'phaseA'
            conf_min = 65
            edge_min = 0.55
        elif bars < 400:
            phase = 'phaseB'
            conf_min = 60
            edge_min = 0.50
        else:
            phase = 'mature'
            conf_min = 15
            edge_min = 0.12

        curr_thresholds = (conf_min, edge_min)

        # æ£€æµ‹çªå˜
        if prev_thresholds:
            conf_diff = abs(curr_thresholds[0] - prev_thresholds[0])
            edge_diff = abs(curr_thresholds[1] - prev_thresholds[1])

            if conf_diff > 0 or edge_diff > 0:
                results.append({
                    'bars': bars,
                    'phase_change': f"{prev_phase} â†’ {phase}",
                    'conf_diff': conf_diff,
                    'edge_diff': edge_diff
                })

        prev_thresholds = curr_thresholds
        prev_phase = phase

    return results

# è¿è¡Œæ£€æµ‹
gaps = detect_gaps()
for gap in gaps:
    print(f"æ–­å±‚ç‚¹: bars={gap['bars']}, {gap['phase_change']}, "
          f"Î”conf={gap['conf_diff']}, Î”edge={gap['edge_diff']:.2f}")
```

**è¾“å‡ºç¤ºä¾‹**ï¼š
```
æ–­å±‚ç‚¹: bars=24, ultra â†’ phaseA, Î”conf=5, Î”edge=0.05
æ–­å±‚ç‚¹: bars=168, phaseA â†’ phaseB, Î”conf=5, Î”edge=0.05
æ–­å±‚ç‚¹: bars=400, phaseB â†’ mature, Î”conf=45, Î”edge=0.38  â† æœ€ä¸¥é‡
```

---

**ç»“è®º**ï¼šæ–°å¸åˆ†ææµç¨‹å­˜åœ¨å¤šä¸ªæ–­å±‚ç‚¹ï¼Œå…¶ä¸­bars=180ç¡¬é—¨æ§›å’Œbars=400é˜¶æ®µåˆ‡æ¢å½±å“æœ€å¤§ï¼Œå»ºè®®ä¼˜å…ˆä¿®å¤ã€‚
